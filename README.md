# ğŸ ãƒã‚¤ã‚¯ãƒˆãƒ©ãƒƒã‚«ãƒ¼

ãƒã‚¤ã‚¯èµ°è¡Œãƒ«ãƒ¼ãƒˆã‚’ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰GPSã§è¨˜éŒ²ãƒ»ç®¡ç†ã™ã‚‹iOSã‚¢ãƒ—ãƒªã€‚

![React Native](https://img.shields.io/badge/React_Native-0.76-61DAFB?logo=react)
![Expo](https://img.shields.io/badge/Expo-52-000020?logo=expo)
![Hono](https://img.shields.io/badge/Hono-4.6-E36002?logo=hono)
![Cloudflare Workers](https://img.shields.io/badge/Cloudflare_Workers-D1-F38020?logo=cloudflare)
![TypeScript](https://img.shields.io/badge/TypeScript-5.6-3178C6?logo=typescript)

---

## æ©Ÿèƒ½

- **ãƒ«ãƒ¼ãƒˆè¨˜éŒ²** â€” ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰GPSã§èµ°è¡Œãƒ«ãƒ¼ãƒˆã‚’è‡ªå‹•è¨˜éŒ²ã€‚ã‚¢ãƒ—ãƒªã‚’é–‰ã˜ã¦ã‚‚è¨˜éŒ²ç¶™ç¶š
- **åœ°å›³è¡¨ç¤º** â€” MapLibre + OpenFreeMapã«ã‚ˆã‚‹ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åœ°å›³ã€‚ç¾åœ¨åœ°ãƒ»ãƒ«ãƒ¼ãƒˆã‚’æç”»
- **å±¥æ­´ç®¡ç†** â€” èµ°è¡Œå±¥æ­´ã®ä¸€è¦§è¡¨ç¤ºã€‚æœŸé–“ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆ1é€±é–“/1ãƒ¶æœˆ/1å¹´/å…¨æœŸé–“ï¼‰ã¨åˆè¨ˆèµ°è¡Œè·é›¢
- **ãƒ«ãƒ¼ãƒˆè©³ç´°** â€” åœ°å›³ä¸Šã«ãƒ«ãƒ¼ãƒˆã‚’æç”»ã—ã€è·é›¢ãƒ»æ™‚é–“ãƒ»å¹³å‡é€Ÿåº¦ãƒ»æœ€é«˜é€Ÿåº¦ã‚’è¡¨ç¤º
- **ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³** â€” ç›®çš„åœ°ã‚’æ¤œç´¢ã—ã¦Google Mapsã‚¢ãƒ—ãƒªã§ãƒŠãƒ“ã‚’èµ·å‹•ï¼ˆãƒ«ãƒ¼ãƒˆè¨˜éŒ²ã¨ä½µç”¨å¯èƒ½ï¼‰
- **ã‚¿ã‚¤ãƒˆãƒ«è‡ªå‹•ç”Ÿæˆ** â€” è¨˜éŒ²å®Œäº†æ™‚ã«å‡ºç™ºåœ°â†’åˆ°ç€åœ°ã‚’é€†ã‚¸ã‚ªã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã§è‡ªå‹•å‘½å
- **èªè¨¼** â€” ãƒ¡ãƒ¼ãƒ«+ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ / Apple IDãƒ­ã‚°ã‚¤ãƒ³å¯¾å¿œ

---

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰

| æŠ€è¡“ | ç”¨é€” |
|------|------|
| React Native + Expo | iOSã‚¢ãƒ—ãƒª |
| Expo Router | ãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚° |
| MapLibre React Native | åœ°å›³æç”»ï¼ˆç„¡æ–™ï¼‰ |
| OpenFreeMap | ãƒ™ã‚¯ã‚¿ãƒ¼ã‚¿ã‚¤ãƒ«é…ä¿¡ï¼ˆç„¡æ–™ãƒ»ç„¡åˆ¶é™ï¼‰ |
| react-native-background-geolocation | ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰GPSè¿½è·¡ |
| Nominatim (OSM) | ä½æ‰€æ¤œç´¢ãƒ»é€†ã‚¸ã‚ªã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼ˆç„¡æ–™ï¼‰ |
| Zustand | çŠ¶æ…‹ç®¡ç† |
| Emotion Native | styled-components |

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰

| æŠ€è¡“ | ç”¨é€” |
|------|------|
| Cloudflare Workers | ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ãƒ©ãƒ³ã‚¿ã‚¤ãƒ  |
| Hono | Webãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ |
| Cloudflare D1 | SQLiteãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ |
| Drizzle ORM | å‹å®‰å…¨ãªDBã‚¢ã‚¯ã‚»ã‚¹ |
| Zod | ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ |
| jose | JWTèªè¨¼ |

---

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### Bulletproof React Feature ãƒ‘ã‚¿ãƒ¼ãƒ³

```
app/
â”œâ”€â”€ app/                    # ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å±¤ï¼ˆè–„ã„ãƒ©ãƒƒãƒ‘ãƒ¼ã®ã¿ï¼‰
â”‚   â”œâ”€â”€ (auth)/             #   ãƒ­ã‚°ã‚¤ãƒ³ãƒ»ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—
â”‚   â””â”€â”€ (tabs)/             #   ãƒãƒƒãƒ—ãƒ»å±¥æ­´ãƒ»è¨­å®š
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ features/           # Feature ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”‚   â”‚   â”œâ”€â”€ auth/           #   èªè¨¼
â”‚   â”‚   â”œâ”€â”€ tracking/       #   GPSè¿½è·¡
â”‚   â”‚   â”œâ”€â”€ map/            #   åœ°å›³ãƒ»æ¤œç´¢ãƒ»ãƒŠãƒ“
â”‚   â”‚   â”œâ”€â”€ history/        #   å±¥æ­´
â”‚   â”‚   â””â”€â”€ settings/       #   è¨­å®š
â”‚   â”œâ”€â”€ components/         # å…±æœ‰UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ lib/                # APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ»ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸
â”‚   â”œâ”€â”€ utils/              # ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆç­‰
â”‚   â””â”€â”€ config/             # å®šæ•°
```

---

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### å‰ææ¡ä»¶

- Node.js 18+
- npmï¼ˆyarn/pnpm/bun ã¯ä½¿ã‚ãªã„ï¼‰
- Xcode 15+ï¼ˆMacï¼‰
- Cloudflare ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆworkers.dev ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ç™»éŒ²æ¸ˆã¿ï¼‰

### 1. ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
npm install        # ãƒ«ãƒ¼ãƒˆ
cd api && npm install
cd ../app && npm install
```

### 2. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆAPIï¼‰åˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
cd api

# Cloudflare ã«ãƒ­ã‚°ã‚¤ãƒ³
npx wrangler login

# D1 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä½œæˆï¼ˆæœ¬ç•ªï¼‰
npx wrangler d1 create bike-tracker-db
# â†’ å‡ºåŠ›ã•ã‚Œã‚‹ database_id ã‚’ wrangler.toml ã«ã‚»ãƒƒãƒˆ

# D1 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä½œæˆï¼ˆã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ï¼‰
npx wrangler d1 create bike-tracker-db-staging
# â†’ å‡ºåŠ›ã•ã‚Œã‚‹ database_id ã‚’ wrangler.toml ã® [env.staging] ã«ã‚»ãƒƒãƒˆ

# JWT ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆè¨­å®š
npx wrangler secret put JWT_SECRET                # æœ¬ç•ª
npx wrangler secret put JWT_SECRET --env staging  # ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°

# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”Ÿæˆ
npm run db:generate
```

### 3. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰åˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
cd app
npx expo prebuild --clean
npx expo run:ios --device "iPhone 17 Pro"  # ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼
```

ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è¿½åŠ å¾Œã¯ `npx expo prebuild --clean` â†’ `npx expo run:ios` ãŒå¿…è¦ã€‚

---

## é–‹ç™ºã‚³ãƒãƒ³ãƒ‰

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆapi/ï¼‰

| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ |
|---------|------|
| `npm run dev` | ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ï¼ˆlocalhost:8788ã€ãƒ­ãƒ¼ã‚«ãƒ«D1ï¼‰ |
| `npm run dev:staging` | ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°DBæ¥ç¶šã§é–‹ç™ºï¼ˆ`--remote`ï¼‰ |
| `npm run db:generate` | Drizzle ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆ |
| `npm run db:migrate:local` | ãƒ­ãƒ¼ã‚«ãƒ«D1ã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é©ç”¨ |
| `npm run db:migrate:staging` | ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°D1ã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é©ç”¨ |
| `npm run db:migrate:remote` | æœ¬ç•ªD1ã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é©ç”¨ |
| `npm run db:seed` | ãƒ­ãƒ¼ã‚«ãƒ«DBã«ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ |
| `npm run deploy` | æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤ |
| `npm run deploy:staging` | ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ãƒ‡ãƒ—ãƒ­ã‚¤ |

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆapp/ï¼‰

```bash
npx expo start                              # Metro bundler èµ·å‹•
npx expo run:ios                            # iOS ãƒ“ãƒ«ãƒ‰ & å®Ÿè¡Œ
npx expo run:ios --device "iPhone 17 Pro"   # ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼æŒ‡å®š
npx expo prebuild --clean                   # ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†ç”Ÿæˆ
```

---

## ãƒ‡ãƒ—ãƒ­ã‚¤

### ãƒ‡ãƒ—ãƒ­ã‚¤å…ˆURL

| ç’°å¢ƒ | URL |
|------|-----|
| æœ¬ç•ª | https://bike-tracker-api.ogaru-sosh.workers.dev |
| ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚° | https://bike-tracker-api-staging.ogaru-sosh.workers.dev |

### ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †

```bash
cd api

# ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°
npm run db:migrate:staging   # DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
npm run deploy:staging       # Workers ãƒ‡ãƒ—ãƒ­ã‚¤

# æœ¬ç•ª
npm run db:migrate:remote    # DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
npm run deploy               # Workers ãƒ‡ãƒ—ãƒ­ã‚¤
```

### æ³¨æ„äº‹é …

- PBKDF2 ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å›æ•°ã¯ Cloudflare Workers ã®åˆ¶é™ã«ã‚ˆã‚Š **100,000å›**ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶æ¨™æº–ã® 600,000 ã§ã¯ãªã„ï¼‰
- `JWT_SECRET` ã¯ `wrangler secret put` ã§ç’°å¢ƒã”ã¨ã«è¨­å®šãŒå¿…è¦
- ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºæ™‚ã®DBã¯ãƒ­ãƒ¼ã‚«ãƒ«D1ï¼ˆ`.wrangler/state/` å†…ï¼‰ã‚’ä½¿ç”¨

---

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT
